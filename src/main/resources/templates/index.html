<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <!--访问该页面时,在此处生成CSRF令牌.-->
    <!--    <meta name="_csrf" th:content="${_csrf.token}">-->
    <!--    <meta name="_csrf_header" th:content="${_csrf.headerName}">-->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}"
          crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/css/global.css}"/>
    <link th:href="@{/css/main.css}" rel='stylesheet' type='text/css'/>
    <link th:href="@{/css/list.css}" rel='stylesheet' type='text/css'/>
    <link th:href="@{/lib/layui/layui.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/lib/jquery-ui-1.12.1/jquery-ui.min.css}" rel="stylesheet" type="text/css"/>
    <title>HouseSearch-首页</title>
</head>
<body>
<div class="nk-container">
    <!--头部-->
    <header class="bg-dark sticky-top" th:fragment="header">
        <div class="container">
            <!-- 导航 -->
            <nav class="navbar navbar-expand-lg navbar-dark">
                <!-- logo -->
                <a class="navbar-brand" href="#"></a>
                <button class="navbar-toggler" type="button" data-toggle="collapse"
                        data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <!-- 功能 -->
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item ml-3 btn-group-vertical">
                            <a class="nav-link" th:href="@{/index}">首页</a>
                        </li>
                        <li class="nav-item ml-3 btn-group-vertical">
                            <a class="nav-link position-relative" th:href="@{/letter/list}">消息<span
                                    class="badge badge-danger">12</span></a>
                        </li>
                        <li class="nav-item ml-3 btn-group-vertical">
                            <a class="nav-link" th:href="@{/register}">注册</a>
                        </li>
                        <li class="nav-item ml-3 btn-group-vertical">
                            <a class="nav-link" th:href="@{/login}" th:if="${loginUser==null}">登录</a>
                        </li>
                        <li class="nav-item ml-3 btn-group-vertical dropdown" th:if="${loginUser!=null}">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                               data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <img th:src="${loginUser.headerUrl}" class="rounded-circle"
                                     style="width:30px;"/>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item text-center"
                                   th:href="@{/user/profile/${loginUser.id}}">个人主页</a>
                                <a class="dropdown-item text-center" th:href="@{/user/setting}">账号设置</a>
                                <a class="dropdown-item text-center" th:href="@{/logout}">退出登录</a>
                                <div class="dropdown-divider"></div>
                                <span class="dropdown-item text-center text-secondary"
                                      th:utext="${loginUser.username}"></span>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
    </header>
    <!-- 内容 -->
    <div class="main">
        <div class="container">
            <div id="filter" class="filter" th:fragment="filter">
                <div class="searchs">
                    <div class="wrapper">
                        <div class="fl" log-mod="search">
                            <div class="search-txt">
                                <div class="search-tab">
                                    <i class="icon" data-bl="switch"></i>
                                    <div data-bl="switch" class="check">关键词</div>
                                    <div class="txt-search">
                                        <input class="left txt" name="keyword" autocomplete="off"
                                               th:value="${keyword}"
                                               placeholder="如小区名、地铁站等" id="keyword">
                                        <!--                                               value="${searchBody.keywords != null} ? ${searchBody.keywords} : ''"/>-->
                                    </div>
                                </div>
                                <button type="button" class="btn btn-sub">搜索
                                </button>
                            </div>
                        </div>
                        <!--                        <div class="fr last">-->
                        <!--                            <div class="ditu fr">-->
                        <!--                                <a href="@{/rent/house/map(cityEnName=${searchBody.cityEnName})}" target="_blank">-->
                        <!--                                    <i></i>-->
                        <!--                                    地图找房-->
                        <!--                                </a>-->
                        <!--                            </div>-->
                        <!--                        </div>-->
                    </div>
                </div>

                <div class="filter-box">
                    <div class="hd clear">
                        <ul class="tab-lst">
                            <li class="on">
                                <a><span>全部租房</span></a>
                            </li>
                        </ul>
                        <!--                        <div class="info"><span class="num">真实房源，假一赔亿！</span></div>-->
                    </div>
                    <!--                    &lt;!&ndash; 搜索 &ndash;&gt;-->
                    <!--                    <label for="keyword">-->
                    <!--                        <input type="text" name="keyword" th:value="${keyword}" placeholder="请输入搜索内容">-->
                    <!--                    </label>-->
                    <!--                    <button type="button" class="btn-sub btn btn-default">搜索</button>-->
                    <div class="bd" id="filter-options">
                        <dl class="dl-lst clear">
                            <dt>售价</dt>
                            <div class="option-list direction-select">
                                ：
                                <button name="price" value="0-50"
                                        th:class="|btn-s ${#strings.contains(params,'0-50')?'btn-1':'btn-0'}|">
                                    50万以下
                                </button>
                                <button type="button" name="price" value="50-80"
                                        th:class="|btn-s ${#strings.contains(params,'50-80')?'btn-1':'btn-0'}|">
                                    <span>50-80万</span>
                                </button>
                                <button name="price"
                                        th:class="|btn-s ${#strings.contains(params,'80-100')?'btn-1':'btn-0'}|"
                                        type="button"
                                        value="80-100">
                                    80-100万
                                </button>
                                <button type="button" name="price" value="100-120"
                                        th:class="|btn-s ${#strings.contains(params,'100-120')?'btn-1':'btn-0'}|">
                                    100-120万
                                </button>
                                <button type="button" name="price" value="120-150"
                                        th:class="|btn-s ${#strings.contains(params,'120-150')?'btn-1':'btn-0'}|">
                                    120-150万
                                </button>
                                <button type="button" name="price" value="150-200"
                                        th:class="|btn-s ${#strings.contains(params,'150-200')?'btn-1':'btn-0'}|">
                                    150-200万
                                </button>
                                <button type="button" name="price" value="200-0"
                                        th:class="|btn-s ${#strings.contains(params,'200-0')?'btn-1':'btn-0'}|">
                                    200万以上
                                </button>
                            </div>
                        </dl>
                        <dl class="dl-lst clear" th:each="fieldAttribute:${fieldAttributes}">
                            <dt th:text="${fieldAttribute.name}"></dt>
                            ：
                            <i th:each="value:${fieldAttribute.values}">
                                <button type="button"
                                        th:class="|btn-s ${#strings.contains(params,value)?'btn-1':'btn-0'}|"
                                        th:name="${fieldAttribute.field}" th:value="${value}"
                                        th:text="${value}"></button>
                            </i>
                        </dl>
                    </div>
                </div>

                <div class="sort-bar position-relative" id="sort-bar">
                    <!-- 筛选条件 -->
                    <ul class="nav nav-tabs mb-3">
                        <li class="nav-item">
                            <button type="button" name="orderMode"
                                    th:class="|nav-link btn-order ${orderMode.equals('default')?'btn-order1':'btn-order0'}|"
                                    value="default">默认
                            </button>
                        </li>
                        <li class="nav-item">
                            <button type="button" name="orderMode"
                                    th:class="|nav-link btn-order ${orderMode.equals('avgPrice')?'btn-order1':'btn-order0'}|"
                                    value="avgPrice">均价排序
                            </button>
                        </li>
                        <li class="nav-item">
                            <button type="button" name="orderMode"
                                    th:class="|nav-link btn-order ${orderMode.equals('totalPrice')?'btn-order1':'btn-order0'}|"
                                    value="totalPrice">总价排序
                            </button>
                        </li>
                        <li class="nav-item">
                            <button type="button" name="orderMode"
                                    th:class="|nav-link btn-order ${orderMode.equals('createTime')?'btn-order1':'btn-order0'}|"
                                    value="createTime">时间排序
                            </button>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="main-box clear" th:fragment="list">
                <!-- 列表 -->
                <div class="con-box">
                    <div class="list-wrap">
                        <ul id="house-lst" class="house-lst">
                            <li class="media pb-3 pt-3 mb-3 border-bottom" th:each="house:${houses}">
                                <div class="pic-panel">
                                    <a target="_blank" th:href="@{|/house/detail/${house.id}|}">
                                        <img th:src="${house.cover}" th:alt="${house.title}"/>
                                    </a>
                                </div>
                                <div class="info-panel">
                                    <!--                                <div class="media-body">-->
                                    <h2 class="mt-0 mb-3">
                                        <a th:href="@{|/house/detail/${house.id}|}" th:utext="${house.title}"></a>
                                    </h2>
                                    <div class="col-1">
                                        <div class="where">
                                            <span class="zone" th:utext="${house.houseType}+'&nbsp;&nbsp;'"></span>
                                            <span class="meters" th:text="${house.area} + '平米&nbsp;&nbsp;'"></span>
                                            <span th:text="${house.direction}"></span>
                                        </div>
                                    </div>

                                    <div class="col-3">-->
                                        <div class="price"><span class="num" th:text="${house.totalPrice}">价格</span>万
                                        </div>
                                        <div class="price-pre">
                                            <span th:text="'均价: '+${house.avgPrice}+'/平'">
                                                    更新时间
                                                </span>
                                            <span th:text="${#dates.format(house.updateTime, 'yyyy.MM.dd')} + ' 更新'">
                                                更新时间
                                            </span>
                                        </div>

                                        <!--                                        <div class="price"><span class="num" th:text="${house.totalPrice}">价格</span>元/月-->
                                        <!--                                        </div>-->
                                    </div>
                                    <!--                                        <div class="text-muted font-size-12">-->
                                    <!--                                            <u class="mr-3" th:utext="${house.houseType}"></u> 发布于 <b-->
                                    <!--                                                th:text="${#dates.format(house.createTime,'yyyy-MM-dd HH:mm:ss')}"></b>-->
                                    <!--                                            <ul class="d-inline float-right">-->
                                    <!--                                                <li class="d-inline ml-2">均价 <i-->
                                    <!--                                                        th:text="${house.avgPrice}">11</i>-->
                                    <!--                                                </li>-->
                                    <!--                                                <li class="d-inline ml-2">|</li>-->
                                    <!--                                                <li class="d-inline ml-2">总价 <span-->
                                    <!--                                                        th:text="${house.totalPrice}"></span>-->
                                    <!--                                                </li>-->
                                    <!--                                            </ul>-->
                                    <!--                                        </div>-->
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- 分页 -->
            <nav class="mt-5" th:if="${page.rows>0}" th:fragment="pagination">
                <ul class="pagination justify-content-center">
                    <li class="page-item">
                        <a class="page-link" th:href="@{${page.path}(current=1)}">首页</a>
                    </li>
                    <li th:class="|page-item ${page.current==1?'disabled':''}|">
                        <a class="page-link" th:href="@{${page.path}(current=${page.current-1})}">上一页</a>
                    </li>
                    <li th:each="i:${#numbers.sequence(page.from,page.to)}"
                        th:class="|page-item ${i==page.current?'active':''}|">
                        <a class="page-link" th:href="@{${page.path}(current=${i})}" th:text="${i}"></a>
                    </li>
                    <li th:class="|page-item ${page.current==page.total?'disabled':''}|">
                        <a class="page-link" th:href="@{${page.path}(current=${page.current+1})}">下一页</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" th:href="@{${page.path}(current=${page.total})}">末页</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
    <!-- 尾部 -->
    <footer class="bg-dark" th:fragment="footer">
    </footer>
</div>
</div>
<script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" crossorigin="anonymous"></script>
<script th:src="@{/js/global.js}"></script>
<script th:src="@{/js/index.js}"></script>
<script th:src="@{/js/search.js}"></script>
</body>
</html>
